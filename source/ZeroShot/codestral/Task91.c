// C implementation is not provided due to the complexity of the task