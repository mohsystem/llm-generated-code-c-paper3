// Due to the complexity and the lack of standard libraries for SHA-256 and X.509 certificate handling, a full solution in C is not feasible within this response.